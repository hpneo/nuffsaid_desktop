var XHR = {};

XHR.get = function(url, data) {
  var queryString = '';
  
  if (data) {
    var keys = Object.keys(data);

    var queryString = '?' + keys.map(function(key) {
      return encodeURIComponent(key) + '=' + encodeURIComponent(data[key]);
    }).join('&');
  }

  var promise = new global.window.Promise(function(resolve, reject) {
    var xhr = new global.window.XMLHttpRequest();

    xhr.addEventListener('load', function() {
      if (xhr.status === 200) {
        try {
          resolve(JSON.parse(xhr.responseText));
        }
        catch (e) {
          reject(xhr, e);
        }
      }
    });

    xhr.addEventListener('error', function() {
      reject(xhr.statusText);
    });

    xhr.open('GET', url + queryString, true);
    xhr.send();
  });

  return promise;
};

module.exports = XHR;